<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../layout/noNavTemplate.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="title">
        View User Details
    </ui:define>

    <ui:define name="head">
        <c:if test="#{viewUserManagedBean.user != null}">
            #{viewUserManagedBean.generateUserDetails()}
        </c:if>
        <h:outputStylesheet name="css/cssLayout.css"/>
        <h:outputStylesheet name="css/default.css"/>
    </ui:define>

    <ui:define name="top">
        
    </ui:define>

    <ui:define name="content">
        <h:form>
            <div class="button-header" style="padding: 15px">
                <a type="button" href="#{viewUserManagedBean.back()}" class="btn btn-primary" role="button">Back</a>
            </div>
            <div align="center">
                <div class="card user-details-card" align="left">
                    <div class="header header-user-detail">
                        #{viewUserManagedBean.user.username}
                    </div>
                    <div class="form-group row">
                        <label for="fullName" class="col-sm-2 col-form-label">Full name</label>
                        <div class="col-sm-10">
                            <h:outputText id="fullName" value="#{viewUserManagedBean.user.firstName} #{viewUserManagedBean.user.lastName}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="age" class="col-sm-2 col-form-label">Age</label>
                        <div class="col-sm-10">
                            <h:outputText id="age" value="#{viewUserManagedBean.user.age}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="userType" class="col-sm-2 col-form-label">User type</label>
                        <div class="col-sm-10">
                            <h:outputText id="userType" value="#{viewUserManagedBean.userType}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="email" class="col-sm-2 col-form-label">Email</label>
                        <div class="col-sm-10">
                            <h:outputText id="email" value="#{viewUserManagedBean.user.email}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="phoneNum" class="col-sm-2 col-form-label">Contact number</label>
                        <div class="col-sm-10">
                            <h:outputText id="phoneNum" value="#{viewUserManagedBean.user.contactNum}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="eContact" class="col-sm-2 col-form-label">Emergency contact</label>
                        <div class="col-sm-10">
                            <h:outputText id="eContact" value="#{viewUserManagedBean.user.emergencyContact}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="bAdd" class="col-sm-2 col-form-label">Billing Address</label>
                        <div class="col-sm-10">
                            <h:outputText id="bAdd" value="#{viewUserManagedBean.user.billingAddress}"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="uStatus" class="col-sm-2 col-form-label">User status</label>
                        <div class="col-sm-10">
                            <h:outputText id="uStatus" value="#{viewUserManagedBean.userStatus}"/>
                            <div class="able-buttons">
                                <p:commandButton value="Enable" disabled="#{viewUserManagedBean.canEnable}" action="#{viewUserManagedBean.enableUser()}" 
                                                 icon="pi pi-check-circle" style="background-color: #00cc99; border-color: transparent;"/>
                                <p:commandButton value="Disable" disabled="#{viewUserManagedBean.canDisable}" action="#{redirectManagedBean.disableUser()}" icon="pi pi-minus-circle"/>
                            </div>
                        </div>
                    </div>
                    <p:messages showDetail="true" skipDetailIfEqualsSummary="true" showSummary="true" closable="true" style="width:20%;"/>
                    <!---display users ratings-->
                    <h3>User's ratings and reports</h3>
                    <p:tabView style="font-size: 12px">
                        <p:tab title="Ratings user received">
                            <c:if test="#{viewUserManagedBean.user.ratingsForUsers.isEmpty()}">
                                <p:staticMessage severity="info" summary="Note: " detail="User has not received any ratings."/>
                            </c:if>
                            <p:dataView var="rarec" value="#{viewUserManagedBean.user.ratingsForUsers}" listIcon="pi pi-bars">

                                <p:dataViewListItem>
                                    <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
                                        <img src="../img/rating.png" style="width: 100px;"/>

                                        <p:outputPanel>
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <h:outputText style="padding: 10px;" value="Rater's UserId:"/>
                                                <h:outputText value="#{rarec.rater.userId}" style="padding: 10px; font-weight: bold;"/>

                                                <h:outputText style="padding: 10px;" value="Rater's username:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rarec.rater.username}"/>

                                                <h:outputText style="padding: 10px;" value="Rating:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rarec.stars}/5"/>

                                                <h:outputText style="padding: 10px;" value="Comment:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rarec.comment}"/>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </h:panelGrid>
                                </p:dataViewListItem>
                            </p:dataView>
                        </p:tab>
                        <p:tab title="Ratings user gave">
                            <c:if test="#{viewUserManagedBean.user.ratingsUserMade.isEmpty()}">
                                <p:staticMessage severity="info" summary="Note: " detail="User has not given any ratings."/>
                            </c:if>
                            <p:dataView var="ragav" value="#{viewUserManagedBean.user.ratingsUserMade}" listIcon="pi pi-bars">

                                <p:dataViewListItem>
                                    <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
                                        <img src="../img/rating.png" style="width: 100px;"/>

                                        <p:outputPanel>
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <h:outputText style="padding: 10px;" value="Rated User's UserId:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{ragav.rated.userId}"/>

                                                <h:outputText style="padding: 10px;" value="Rater's username:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{ragav.rated.username}"/>

                                                <h:outputText style="padding: 10px;" value="Rating:"/>
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{ragav.stars}/5"/>

                                                <h:outputText style="padding: 10px;" value="Comment:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{ragav.comment}"/>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </h:panelGrid>
                                </p:dataViewListItem>
                            </p:dataView>
                        </p:tab>
                        <p:tab title="Reports user received">
                            <c:if test="#{viewUserManagedBean.user.reportsAgainstUser.isEmpty()}">
                                <p:staticMessage severity="info" summary="Note: " detail="User has not received any reports."/>
                            </c:if>
                            <p:dataView var="rerec" value="#{viewUserManagedBean.user.reportsAgainstUser}" listIcon="pi pi-bars">

                                <p:dataViewListItem>
                                    <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
                                        <img src="../img/reported.jpg" style="width: 100px;"/>

                                        <p:outputPanel>
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <h:outputText style="padding: 10px;" value="Reporter's UserId:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rerec.reporter.userId}"/>

                                                <h:outputText style="padding: 10px;" value="Reporter's username:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rerec.reporter.username}"/>

                                                <h:outputText style="padding: 10px;" value="Report description:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{rerec.reportDescription}"/>

                                                <h:outputText style="padding: 10px;" value="Valid:" />
                                                <c:choose>
                                                    <c:when test="#{rerec.valid}">
                                                        <i class="pi pi-check" style="font-size: 2rem"></i>
                                                    </c:when>
                                                    <c:when test="#{rerec.valid == null}">
                                                        <i class="pi pi-question" style="font-size: 2rem"></i>
                                                    </c:when>
                                                    <c:otherwise>
                                                        <i class="pi pi-times" style="font-size: 2rem"></i>
                                                    </c:otherwise>
                                                </c:choose>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </h:panelGrid>
                                </p:dataViewListItem>
                            </p:dataView>
                        </p:tab>
                        <p:tab title="Reports user made">
                            <c:if test="#{viewUserManagedBean.user.reportsUserMade.isEmpty()}">
                                <p:staticMessage severity="info" summary="Note: " detail="User has not made any reports."/>
                            </c:if>
                            <p:dataView var="regav" value="#{viewUserManagedBean.user.reportsUserMade}" listIcon="pi pi-bars">

                                <p:dataViewListItem>
                                    <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
                                        <img src="../img/reported.jpg" style="width: 100px;"/>

                                        <p:outputPanel>
                                            <h:panelGrid columns="2" cellpadding="5">
                                                <h:outputText style="padding: 10px;" value="Reported user's UserId:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{regav.reported.userId}"/>

                                                <h:outputText style="padding: 10px;" value="Reported user's username:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{regav.reported.username}"/>

                                                <h:outputText style="padding: 10px;" value="Report description:" />
                                                <h:outputText style="padding: 10px; font-weight: bold;" value="#{regav.reportDescription}"/>

                                                <h:outputText style="padding: 10px;" value="Valid:" />
                                                <c:choose>
                                                    <c:when test="#{regav.valid}">
                                                        <i class="pi pi-check" style="font-size: 2rem"></i>
                                                    </c:when>
                                                    <c:when test="#{rerec.valid == null}">
                                                        <i class="pi pi-question" style="font-size: 2rem"></i>
                                                    </c:when>
                                                    <c:otherwise>
                                                        <i class="pi pi-times" style="font-size: 2rem"></i>
                                                    </c:otherwise>
                                                </c:choose>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </h:panelGrid>
                                </p:dataViewListItem>
                            </p:dataView>
                        </p:tab>
                    </p:tabView>
                </div>
            </div>
        </h:form>
    </ui:define>

    <ui:define name="bottom">

    </ui:define>

</ui:composition>
